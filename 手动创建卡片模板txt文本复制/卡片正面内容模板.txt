<div class="md-content">
  {{Front}}
</div>


<script>
  var getResources = [
    getScript("https://gcore.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js"),
    getScript("https://gcore.jsdelivr.net/gh/highlightjs/cdn-release@11.11.1/build/highlight.min.js"),
  ];

  // åŠ è½½èµ„æºå¹¶åˆå§‹åŒ–
  Promise.all(getResources)
    .then(() => {
      parseMarkDownFn();
    })
    .catch(error => {
      consoleLog('Failed to load required resources: ' + error);
    });

  function getScript(url) {
    return new Promise((resolve, reject) => {
      const script = document.createElement("script");
      script.onload = resolve;
      script.onerror = () => reject(new Error(`Failed to load script from ${url}`));
      script.src = url;
      document.head.appendChild(script);
    });
  }
  // åœ¨ankiä¸­é€šè¿‡çª—å£æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯ æ²¡æ§åˆ¶å°å•Š
  function consoleLog(str) {
    var div = document.createElement('div')
    div.innerHTML = str
    document.body.appendChild(div)
  }

  // æ¸…é™¤bræ ‡ç­¾
  // ankiè‡ªåŠ¨ç”Ÿæˆçš„<br>å…¨éƒ¨å¹²æ‰ ä¸¥æ ¼æŒ‰ç…§åŸç”Ÿæ¢è¡Œæ¥å†™
  var clearBR = (str) => {
    str = str.replace(/<br>/g, '\r\n')
    return str
  }

  // æ¸…é™¤ç©ºæ ¼å®ä½“å­—ç¬¦
  var clearBlankNbsp = (str) => {
    str = str.replace(/&nbsp;/g, ' ')
    return str
  }

  // åè½¬ä¹‰ HTML å®ä½“ï¼Œç¡®ä¿å¡ç‰‡ä¸­æ‰€æœ‰çš„ç¬¦å·æ­£å¸¸
  // Eg. #include <stdio.h>
  var unescapeHTMLEntities = (innerHTML) =>
    Object.assign(document.createElement('textarea'), { innerHTML }).value

  // è§£æï¼ˆå…¥å£mainæ–¹æ³•ï¼‰
  var parseMarkDownFn = () => {
    const md = markdownit({
      html: true, // è‹¥ä¸º false å°†å¯¼è‡´ anki è‡ªå¸¦çš„å…¬å¼æ¸²æŸ“å¤±æ•ˆã€‚
      linkify: true,
      typographer: true,
      breaks: true,
      highlight: function (str, lang) {
        if (lang && hljs.getLanguage(lang)) {
          try {
            return hljs.highlight(str, { language: lang }).value
          } catch (__) { }
        }

        return '' // use external default escaping
      },
    })
    document.querySelectorAll('.md-content').forEach((div, index) => {
      console.log('æŸ¥æ‰¾åˆ°çš„å®¹å™¨å…ƒç´ ', div)
      // éœ€è¦å»é™¤é¦–å°¾ç©ºæ ¼ ä¸ç„¶markdown-itä¼šè§£æé”™è¯¯
      var text = unescapeHTMLEntities(div.innerHTML).trim()
      console.log('text', text)
      // æ¸…é™¤bræ ‡ç­¾
      text = clearBR(text)
      // ğŸ‘‡å…³é”®æ ¸å¿ƒmdè½¬æ¢
      var html = md.render(text)
      var newDiv = document.createElement('div')
      var hr = document.createElement('hr')
      newDiv.innerHTML = html
      // æ¿€æ´»github-markdown-css
      newDiv.className = 'markdown-body'
      div.parentNode.insertBefore(newDiv, div.nextSibling)

      index === 1 ? div.parentNode.insertBefore(hr, div.nextSibling) : null
      div.className = `x-${index}`
      div.style.display = 'none'
      // ä¸èƒ½ä»bodyç›´æ¥æ’å…¥å…ƒç´  anki ä¸åˆ·æ–°çš„
    })
  }
</script>
