<!DOCTYPE html>
<html lang="cn">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.8.1/github-markdown.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/onedark.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
    />
    <script
      defer
      src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/highlight.js/11.4.0/highlight.min.js"
    ></script>
    <title>anki-mdæ¨¡æ¿æµ‹è¯•</title>
  </head>
  <style>
    .markdown-body {
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }
    @media (max-width: 767px) {
      .markdown-body {
        padding: 15px;
      }
    }
    /* åˆå§‹çŠ¶æ€ä¸‹è®¾ç½®é€æ˜åº¦ä¸º0 */
    .md-content {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
  </style>
  <body>
    <!-- prettier-ignore -->
    <div class="md-content">
### æˆ‘çœ‹showdownçœŸæ˜¯è€ç³Šæ¶‚äº†
    </div>
    <!-- prettier-ignore -->
    <div class="md-content">

> å‘µå‘µå‘µ
> å‘µå‘µå‘µå“ˆå“ˆå“ˆå“ˆ

> å–œå–œ

# ä¸€çº§æ ‡é¢˜
## äºŒçº§æ ‡é¢˜
### ä¸‰çº§æ ‡é¢˜
#### å››çº§æ ‡é¢˜
##### äº”çº§æ ‡é¢˜
###### å…­çº§æ ‡é¢˜
---
**åŠ ç²—**
*æ–œä½“*
***åŠ ç²—æ–œä½“***
---
> å¼•ç”¨
---
- æ— åºåˆ—è¡¨
- æ— åºåˆ—è¡¨
- æ— åºåˆ—è¡¨
---
1. æœ‰åºåˆ—è¡¨
2. æœ‰åºåˆ—è¡¨
3. æœ‰åºåˆ—è¡¨
---
[é“¾æ¥](https://www.baidu.com)
---
![å›¾ç‰‡](https://www.baidu.com/img/bd_logo1.png)
---
`è¡Œå†…ä»£ç `
---
```javascript
// ä»£ç å—
console.log('hello world')
```
    </div>
    <!-- 
      æ•´ä¸ªscriptå†…å®¹(åŒ…æ‹¬scriptæ ‡ç­¾)
      éœ€è¦å¤åˆ¶åˆ°ankiçš„å¡ç‰‡æ¨¡æ¿ä¸­
    -->
    <!-- https://github.com/markdown-it/markdown-it -->
    <script
      defer
      src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/markdown-it/12.3.2/markdown-it.min.js"
    ></script>
    <!-- ä»£ç é«˜äº®åº“ -->
    <script
      defer
      src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/highlight.js/11.4.0/highlight.min.js"
    ></script>
    <script defer>
      "use strict";
      // åœ¨ankiä¸­é€šè¿‡çª—å£æŸ¥çœ‹è°ƒè¯•ä¿¡æ¯ æ²¡æ§åˆ¶å°å•Š
      function consoleLog(str) {
        var div = document.createElement("div");
        div.innerHTML = str;
        document.body.appendChild(div);
      }

      // æ¸…é™¤bræ ‡ç­¾
      // ankiè‡ªåŠ¨ç”Ÿæˆçš„<br>å…¨éƒ¨å¹²æ‰ ä¸¥æ ¼æŒ‰ç…§åŸç”Ÿæ¢è¡Œæ¥å†™
      var clearBR = (str) => {
        str = str.replace(/<br>/g, "\r\n");
        return str;
      };

      // æ¸…é™¤ç©ºæ ¼å®ä½“å­—ç¬¦
      var clearBlankNbsp = (str) => {
        str = str.replace(/&nbsp;/g, " ");
        return str;
      };

      // åè½¬ä¹‰ HTML å®ä½“ï¼Œç¡®ä¿å¡ç‰‡ä¸­æ‰€æœ‰çš„ç¬¦å·æ­£å¸¸
      // Eg. #include <stdio.h>
      var unescapeHTMLEntities = (innerHTML) =>
        Object.assign(document.createElement("textarea"), { innerHTML }).value;

      // è§£æï¼ˆå…¥å£mainæ–¹æ³•ï¼‰
      var parseMarkDownFn = () => {
        const md = markdownit({
          html: true, // è‹¥ä¸º false å°†å¯¼è‡´ anki è‡ªå¸¦çš„å…¬å¼æ¸²æŸ“å¤±æ•ˆã€‚
          linkify: true,
          typographer: true,
          breaks: true,
          highlight: function (str, lang) {
            if (lang && hljs.getLanguage(lang)) {
              try {
                return hljs.highlight(str, { language: lang }).value;
              } catch (__) {}
            }

            return ""; // use external default escaping
          },
        });
        document.querySelectorAll(".md-content").forEach((div, index) => {
          console.log("æŸ¥æ‰¾åˆ°çš„å®¹å™¨å…ƒç´ ", div);
          // éœ€è¦å»é™¤é¦–å°¾ç©ºæ ¼ ä¸ç„¶markdown-itä¼šè§£æé”™è¯¯
          var text = unescapeHTMLEntities(div.innerHTML).trim();
          console.log("text", text);
          // æ¸…é™¤bræ ‡ç­¾
          text = clearBR(text);
          // ğŸ‘‡å…³é”®æ ¸å¿ƒmdè½¬æ¢
          var html = md.render(text);
          var newDiv = document.createElement("div");
          var hr = document.createElement("hr");
          newDiv.innerHTML = html;
          // æ¿€æ´»github-markdown-css
          newDiv.className = "markdown-body";
          div.parentNode.insertBefore(newDiv, div.nextSibling);

          index === 1 ? div.parentNode.insertBefore(hr, div.nextSibling) : null;
          div.className = `x-${index}`;
          div.style.display = "none";
          // ä¸èƒ½ä»bodyç›´æ¥æ’å…¥å…ƒç´  anki ä¸åˆ·æ–°çš„
        });
      };
      // TEMP å¤åˆ¶åˆ°å¡ç‰‡ä¸­è¦æ‰“å¼€æ³¨é‡Š å»æ‰ä¸‹è¾¹çš„ä»£ç ã€‚
      // parseMarkDownFn();

      // TEMP åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•çš„æ—¶å€™ä½¿ç”¨
      document.addEventListener("DOMContentLoaded", function () {
        // ä½ çš„ä¸»è¦ä»£ç 
        "use strict";
        parseMarkDownFn();
      });
    </script>
  </body>
</html>
